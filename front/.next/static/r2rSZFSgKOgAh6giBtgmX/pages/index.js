(window.webpackJsonp=window.webpackJsonp||[]).push([["static\\r2rSZFSgKOgAh6giBtgmX\\pages\\index.js"],{RNiq:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs2/regenerator */ "ln6h");\n/* harmony import */ var _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "q1tI");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-redux */ "/MKj");\n/* harmony import */ var _containers_PostForm__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../containers/PostForm */ "yanB");\n/* harmony import */ var _containers_PostCard__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../containers/PostCard */ "uor+");\n/* harmony import */ var _reducers_post__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../reducers/post */ "p+NB");\n\nvar __jsx = react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement;\n\n\n\n\n\n\nvar Home = function Home() {\n  var _useSelector = Object(react_redux__WEBPACK_IMPORTED_MODULE_2__["useSelector"])(function (state) {\n    return state.user;\n  }),\n      me = _useSelector.me;\n\n  var _useSelector2 = Object(react_redux__WEBPACK_IMPORTED_MODULE_2__["useSelector"])(function (state) {\n    return state.post;\n  }),\n      mainPosts = _useSelector2.mainPosts,\n      hasMorePost = _useSelector2.hasMorePost;\n\n  var dispatch = Object(react_redux__WEBPACK_IMPORTED_MODULE_2__["useDispatch"])(); // \ud504\ub860\ud2b8\ub2e8\uc5d0\uc11c \ub9ac\ub355\uc2a4 \uc561\uc158\uc744 \ud55c \ubc88\ub9cc \ud638\ucd9c\ub418\uac8c \uc218\uc815\n\n  var countRef = Object(react__WEBPACK_IMPORTED_MODULE_1__["useRef"])([]);\n  var onScroll = Object(react__WEBPACK_IMPORTED_MODULE_1__["useCallback"])(function () {\n    // console.log(window.scrollY, document.documentElement.clientHeight, document.documentElement.scrollHeight)\n    if (window.scrollY + document.documentElement.clientHeight > document.documentElement.scrollHeight - 300) {\n      if (hasMorePost) {\n        var lastId = mainPosts[mainPosts.length - 1].id;\n\n        if (!countRef.current.includes(lastId)) {\n          dispatch({\n            type: _reducers_post__WEBPACK_IMPORTED_MODULE_5__["LOAD_MAIN_POSTS_REQUEST"],\n            lastId: lastId\n          });\n          countRef.current.push(lastId);\n        }\n      }\n    }\n  }, [hasMorePost, mainPosts.length]);\n  Object(react__WEBPACK_IMPORTED_MODULE_1__["useEffect"])(function () {\n    window.addEventListener("scroll", onScroll);\n    return function () {\n      window.removeEventListener("scroll", onScroll);\n    };\n  }, [mainPosts.length]);\n  return __jsx("div", null, me && __jsx(_containers_PostForm__WEBPACK_IMPORTED_MODULE_3__["default"], null), mainPosts.map(function (c) {\n    return __jsx(_containers_PostCard__WEBPACK_IMPORTED_MODULE_4__["default"], {\n      key: c.id,\n      post: c\n    });\n  }));\n};\n\nHome.getInitialProps = function _callee(context) {\n  return _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          // console.log(Object.keys(context.store));\n          context.store.dispatch({\n            type: _reducers_post__WEBPACK_IMPORTED_MODULE_5__["LOAD_MAIN_POSTS_REQUEST"]\n          });\n\n        case 1:\n        case "end":\n          return _context.stop();\n      }\n    }\n  });\n};\n\n/* harmony default export */ __webpack_exports__["default"] = (Home);\n\n//# sourceURL=webpack:///./pages/index.js?')},vlRD:function(module,exports,__webpack_require__){eval('\n    (window.__NEXT_P=window.__NEXT_P||[]).push(["/", function() {\n      var mod = __webpack_require__(/*! private-next-pages/index.js */ "RNiq")\n      if(false) {}\n      return mod\n    }]);\n  \n\n//# sourceURL=webpack:///./node_modules/next/dist/build/webpack/loaders/next-client-pages-loader.js?')},yanB:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "q1tI");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! antd */ "gdfu");\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-redux */ "/MKj");\n/* harmony import */ var _reducers_post__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../reducers/post */ "p+NB");\nvar __jsx = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement;\n\n\n\n\n\nvar PostForm = function PostForm() {\n  var dispatch = Object(react_redux__WEBPACK_IMPORTED_MODULE_2__["useDispatch"])();\n\n  var _useState = Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])(""),\n      text = _useState[0],\n      setText = _useState[1];\n\n  var _useSelector = Object(react_redux__WEBPACK_IMPORTED_MODULE_2__["useSelector"])(function (state) {\n    return state.post;\n  }),\n      imagePaths = _useSelector.imagePaths,\n      isAddingPost = _useSelector.isAddingPost,\n      postAdded = _useSelector.postAdded;\n\n  var imageInput = Object(react__WEBPACK_IMPORTED_MODULE_0__["useRef"])();\n  Object(react__WEBPACK_IMPORTED_MODULE_0__["useEffect"])(function () {\n    setText("");\n  }, [postAdded === true]);\n  var onSubmitForm = Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(function (e) {\n    e.preventDefault();\n\n    if (!text || !text.trim()) {\n      return alert("\uac8c\uc2dc\uae00\uc744 \uc791\uc131\ud558\uc138\uc694.");\n    }\n\n    var formData = new FormData();\n    imagePaths.forEach(function (i) {\n      formData.append("image", i);\n    });\n    formData.append("content", text);\n    dispatch({\n      type: _reducers_post__WEBPACK_IMPORTED_MODULE_3__["ADD_POST_REQUEST"],\n      data: formData\n    });\n  }, [text, imagePaths]);\n  var onChangeText = Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(function (e) {\n    setText(e.target.value);\n  }, []);\n  var onChangeImages = Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(function (e) {\n    // console.log(e.target.files);\n    var imageFormData = new FormData();\n    [].forEach.call(e.target.files, function (f) {\n      imageFormData.append("image", f);\n    });\n    dispatch({\n      type: _reducers_post__WEBPACK_IMPORTED_MODULE_3__["UPLOAD_IMAGES_REQUEST"],\n      data: imageFormData\n    });\n  }, []);\n  var onClickImageUpload = Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(function () {\n    imageInput.current.click();\n  }, [imageInput.current]);\n  var onRemoveImage = Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(function (index) {\n    return function () {\n      dispatch({\n        type: _reducers_post__WEBPACK_IMPORTED_MODULE_3__["REMOVE_IMAGE"],\n        index: index\n      });\n    };\n  }, []);\n  return __jsx(antd__WEBPACK_IMPORTED_MODULE_1__["Form"], {\n    encType: "multipart/form-data",\n    onSubmit: onSubmitForm,\n    style: {\n      margin: "10px 0 20px"\n    }\n  }, __jsx(antd__WEBPACK_IMPORTED_MODULE_1__["Input"].TextArea, {\n    maxLength: 140,\n    placeholder: "\\uC5B4\\uB5A4 \\uC2E0\\uAE30\\uD55C \\uC77C\\uC774 \\uC788\\uC5C8\\uB098\\uC694?",\n    value: text,\n    onChange: onChangeText\n  }), __jsx("div", null, __jsx("input", {\n    type: "file",\n    multiple: true,\n    hidden: true,\n    ref: imageInput,\n    onChange: onChangeImages\n  }), __jsx(antd__WEBPACK_IMPORTED_MODULE_1__["Button"], {\n    onClick: onClickImageUpload\n  }, "\\uC774\\uBBF8\\uC9C0 \\uC5C5\\uB85C\\uB4DC"), __jsx(antd__WEBPACK_IMPORTED_MODULE_1__["Button"], {\n    type: "primary",\n    style: {\n      "float": "right"\n    },\n    htmlType: "submit",\n    loading: isAddingPost\n  }, "\\uC9F9\\uC9F9")), __jsx("div", null, imagePaths.map(function (v, i) {\n    return __jsx("div", {\n      key: v,\n      style: {\n        display: "inline-block"\n      }\n    }, __jsx("img", {\n      src: "http://localhost:3065/".concat(v),\n      style: {\n        width: "200px"\n      },\n      alt: v\n    }), __jsx("div", null, __jsx(antd__WEBPACK_IMPORTED_MODULE_1__["Button"], {\n      onClick: onRemoveImage(i)\n    }, "\\uC81C\\uAC70")));\n  })));\n};\n\n/* harmony default export */ __webpack_exports__["default"] = (PostForm);\n\n//# sourceURL=webpack:///./containers/PostForm.js?')}},[["vlRD","static/runtime/webpack.js","framework","aec7d165","commons","92e9d834d4e2803ad400ac329dbb3a217999426a","38993b654796d8ab6a2076055a82d6da4739f1ba","71a112ce4086df6c75fe393c55142c1df35991c9","b136f7b6f4816925c93c718804ff2f73c603bd3b","e690bd6b39befd74028d8aefc99de3cd804837c0","b80a0a4b359f345aed754be0aca54ef394f4356b"]]]);