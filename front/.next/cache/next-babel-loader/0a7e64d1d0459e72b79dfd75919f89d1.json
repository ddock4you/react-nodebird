{"ast":null,"code":"import produce from \"immer\";\nexport const initialState = {\n  mainPosts: [],\n  // 화면에 보일 포스트들\n  imagePaths: [],\n  // 미리보기 이미지 경로\n  addPostErrorReason: false,\n  // 포스트 업로드 실패 사유\n  isAddingPost: false,\n  // 포스트 업로드 중\n  postAdded: false,\n  // 포스트 업로드 성공\n  isAddingComment: false,\n  addCommentErrorReason: \"\",\n  commentAdded: false,\n  singlePost: null\n};\nexport const LOAD_MAIN_POSTS_REQUEST = \"LOAD_MAIN_POSTS_REQUEST\";\nexport const LOAD_MAIN_POSTS_SUCCESS = \"LOAD_MAIN_POSTS_SUCCESS\";\nexport const LOAD_MAIN_POSTS_FAILURE = \"LOAD_MAIN_POSTS_FAILURE\";\nexport const LOAD_HASHTAG_POSTS_REQUEST = \"LOAD_HASHTAG_POSTS_REQUEST\";\nexport const LOAD_HASHTAG_POSTS_SUCCESS = \"LOAD_HASHTAG_POSTS_SUCCESS\";\nexport const LOAD_HASHTAG_POSTS_FAILURE = \"LOAD_HASHTAG_POSTS_FAILURE\";\nexport const LOAD_USER_POSTS_REQUEST = \"LOAD_USER_POSTS_REQUEST\";\nexport const LOAD_USER_POSTS_SUCCESS = \"LOAD_USER_POSTS_SUCCESS\";\nexport const LOAD_USER_POSTS_FAILURE = \"LOAD_USER_POSTS_FAILURE\";\nexport const UPLOAD_IMAGES_REQUEST = \"UPLOAD_IMAGES_REQUEST\";\nexport const UPLOAD_IMAGES_SUCCESS = \"UPLOAD_IMAGES_SUCCESS\";\nexport const UPLOAD_IMAGES_FAILURE = \"UPLOAD_IMAGES_FAILURE\";\nexport const REMOVE_IMAGE = \"REMOVE_IMAGE\";\nexport const ADD_POST_REQUEST = \"ADD_POST_REQUEST\";\nexport const ADD_POST_SUCCESS = \"ADD_POST_SUCCESS\";\nexport const ADD_POST_FAILURE = \"ADD_POST_FAILURE\";\nexport const LIKE_POST_REQUEST = \"LIKE_POST_REQUEST\";\nexport const LIKE_POST_SUCCESS = \"LIKE_POST_SUCCESS\";\nexport const LIKE_POST_FAILURE = \"LIKE_POST_FAILURE\";\nexport const UNLIKE_POST_REQUEST = \"UNLIKE_POST_REQUEST\";\nexport const UNLIKE_POST_SUCCESS = \"UNLIKE_POST_SUCCESS\";\nexport const UNLIKE_POST_FAILURE = \"UNLIKE_POST_FAILURE\";\nexport const ADD_COMMENT_REQUEST = \"ADD_COMMENT_REQUEST\";\nexport const ADD_COMMENT_SUCCESS = \"ADD_COMMENT_SUCCESS\";\nexport const ADD_COMMENT_FAILURE = \"ADD_COMMENT_FAILURE\";\nexport const LOAD_COMMENTS_REQUEST = \"LOAD_COMMENTS_REQUEST\";\nexport const LOAD_COMMENTS_SUCCESS = \"LOAD_COMMENTS_SUCCESS\";\nexport const LOAD_COMMENTS_FAILURE = \"LOAD_COMMENTS_FAILURE\";\nexport const RETWEET_REQUEST = \"RETWEET_REQUEST\";\nexport const RETWEET_SUCCESS = \"RETWEET_SUCCESS\";\nexport const RETWEET_FAILURE = \"RETWEET_FAILURE\";\nexport const REMOVE_POST_REQUEST = \"REMOVE_POST_REQUEST\";\nexport const REMOVE_POST_SUCCESS = \"REMOVE_POST_SUCCESS\";\nexport const REMOVE_POST_FAILURE = \"REMOVE_POST_FAILURE\";\nexport const LOAD_POST_REQUEST = \"LOAD_POST_REQUEST\";\nexport const LOAD_POST_SUCCESS = \"LOAD_POST_SUCCESS\";\nexport const LOAD_POST_FAILURE = \"LOAD_POST_FAILURE\";\nexport default ((state = initialState, action) => {\n  return produce(state, draft => {\n    switch (action.type) {\n      case UPLOAD_IMAGES_REQUEST:\n        {\n          break; // return {\n          //     ...state\n          // };\n        }\n\n      case UPLOAD_IMAGES_SUCCESS:\n        {\n          action.data.forEach(p => {\n            draft.imagePaths.push(p);\n          }); // draft 또다른 표현 방법\n          // draft.imagePaths = draft.imagePaths.concat(action.data);\n\n          break; // return {\n          //     ...state,\n          //     imagePaths: [...state.imagePaths, ...action.data]\n          // };\n        }\n\n      case UPLOAD_IMAGES_FAILURE:\n        {\n          break; // return {\n          //     ...state\n          // };\n        }\n\n      case REMOVE_IMAGE:\n        {\n          const index = draft.imagePaths.findIndex((v, i) => action.index);\n          draft.imagePaths = splice(index, 1);\n          break; // return {\n          //     ...state,\n          //     imagePaths: state.imagePaths.filter(\n          //         (v, i) => i !== action.index\n          //     )\n          // };\n        }\n\n      case ADD_POST_REQUEST:\n        {\n          draft.isAddingPost = true, draft.addPostErrorReason = \"\", draft.Added = false;\n          break; // return {\n          //     ...state,\n          //     isAddingPost: true,\n          //     addPostErrorReason: \"\",\n          //     postAdded: false\n          // };\n        }\n\n      case ADD_POST_SUCCESS:\n        {\n          draft.isAddingPost = false;\n          draft.mainPosts.unshift(action.data);\n          draft.postAdded = true;\n          draft.imagePaths = [];\n          break; // return {\n          //     ...state,\n          //     isAddingPost: false,\n          //     mainPosts: [action.data, ...state.mainPosts],\n          //     postAdded: true,\n          //     imagePaths: []\n          // };\n        }\n\n      case ADD_POST_FAILURE:\n        {\n          draft.isAddingPost = false;\n          draft.addPostErrorReason = action.error;\n          break; // return {\n          //     ...state,\n          //     isAddingPost: false,\n          //     addPostErrorReason: action.error\n          // };\n        }\n\n      case ADD_COMMENT_REQUEST:\n        {\n          draft.isAddingComment = true;\n          draft.addCommentErrorReason = \"\";\n          draft.commentAdded = false;\n          break; // return {\n          //     ...state,\n          //     isAddingComment: true,\n          //     addCommentErrorReason: \"\",\n          //     commentAdded: false\n          // };\n        }\n\n      case ADD_COMMENT_SUCCESS:\n        {\n          const postIndex = draft.mainPosts.findIndex(v => v.id === action.data.postId);\n          draft.mainPosts[postIndex].Comments.push(action.data.comment);\n          draft.isAddingComment = false;\n          draft.commentAdded = true;\n          break; // const postIndex = state.mainPosts.findIndex(\n          //     v => v.id === action.data.postId\n          // );\n          // const post = state.mainPosts[postIndex];\n          // const Comments = [...post.Comments, action.data.comment];\n          // const mainPosts = [...state.mainPosts];\n          // mainPosts[postIndex] = { ...post, Comments };\n          // return {\n          //     ...state,\n          //     isAddingComment: false,\n          //     mainPosts,\n          //     commentAdded: true\n          // };\n        }\n\n      case ADD_COMMENT_FAILURE:\n        {\n          draft.isAddingComment = false;\n          draft.addCommentErrorReason = action.error; // return {\n          //     ...state,\n          //     isAddingComment: false,\n          //     addCommentErrorReason: action.error\n          // };\n        }\n\n      case LOAD_COMMENTS_SUCCESS:\n        {\n          const postIndex = draft.mainPosts.findIndex(v => v.id === action.data.postId);\n          draft.mainPosts[postIndex].Comments = action.data.comments;\n          break; // const postIndex = state.mainPosts.findIndex(\n          //     v => v.id === action.data.postId\n          // );\n          // const post = state.mainPosts[postIndex];\n          // const Comments = action.data.comments;\n          // const mainPosts = [...state.mainPosts];\n          // mainPosts[postIndex] = { ...post, Comments };\n          // return {\n          //     ...state,\n          //     mainPosts\n          // };\n        }\n      // a\n\n      case LOAD_MAIN_POSTS_REQUEST:\n      case LOAD_HASHTAG_POSTS_REQUEST:\n      case LOAD_USER_POSTS_REQUEST:\n        {\n          draft.mainPosts = !action.lastId ? [] : state.mainPosts;\n          draft.hasMorePost = action.lastId ? state.hasMorePost : true;\n          break; // return {\n          //     ...state,\n          //     // 페이지 처음 들어왔을 땐 초기화하고 기존 게시글 보고 있는\n          //     // 상태에서 스크롤 내릴 땐 기존 게시글들 유지\n          //     mainPosts: action.lastId === 0 ? [] : state.mainPosts,\n          //     hasMorePost: action.lastId ? state.hasMorePost : true\n          // };\n        }\n\n      case LOAD_MAIN_POSTS_SUCCESS:\n      case LOAD_HASHTAG_POSTS_SUCCESS:\n      case LOAD_USER_POSTS_SUCCESS:\n        {\n          action.data.forEach(d => {\n            draft.mainPosts.push(d);\n          });\n          draft.hasMorePost = action.data.length === 10;\n          break; // return {\n          //     ...state,\n          //     mainPosts: state.mainPosts.concat(action.data),\n          //     hasMorePost: action.data.length === 10 // 스크롤을 더 활성화할지 말지 결정\n          // };\n        }\n\n      case LOAD_MAIN_POSTS_FAILURE:\n      case LOAD_HASHTAG_POSTS_FAILURE:\n      case LOAD_USER_POSTS_FAILURE:\n        {\n          break;\n        }\n\n      case LIKE_POST_REQUEST:\n        {\n          break;\n        }\n\n      case LIKE_POST_SUCCESS:\n        {\n          const postIndex = draft.mainPosts.findIndex(v => v.id === action.data.postId);\n          draft.mainPosts[postIndex].Likers.unshift({\n            id: action.data.userId\n          });\n          break; // const postIndex = state.mainPosts.findIndex(\n          //     v => v.id === action.data.postId\n          // );\n          // const post = state.mainPosts[postIndex];\n          // const Likers = [{ id: action.data.userId }, ...post.Likers];\n          // const mainPosts = [...state.mainPosts];\n          // mainPosts[postIndex] = { ...post, Likers };\n          // return {\n          //     ...state,\n          //     mainPosts\n          // };\n        }\n\n      case LIKE_POST_FAILURE:\n        {\n          break; // return {\n          //     ...state\n          // };\n        }\n\n      case UNLIKE_POST_REQUEST:\n        {\n          break; // return {\n          //     ...state\n          // };\n        }\n\n      case UNLIKE_POST_SUCCESS:\n        {\n          const postIndex = draft.mainPosts.findIndex(v => v.id === action.data.postId);\n          const likeIndex = draft.mainPosts[postIndex].Likers.findIndex(v => v.id === action.data.userId);\n          draft.mainPosts[postIndex].Likers.splice(likeIndex, 1); // const postIndex = state.mainPosts.findIndex(\n          //     v => v.id === action.data.postId\n          // );\n          // const post = state.mainPosts[postIndex];\n          // const Likers = post.Likers.filter(\n          //     v => v.id !== action.data.userId\n          // );\n          // const mainPosts = [...state.mainPosts];\n          // mainPosts[postIndex] = { ...post, Likers };\n          // return {\n          //     ...state,\n          //     mainPosts\n          // };\n        }\n\n      case UNLIKE_POST_FAILURE:\n        {\n          break; // return {\n          //     ...state\n          // };\n        }\n\n      case RETWEET_REQUEST:\n        {\n          break; // return {\n          //     ...state\n          // };\n        }\n\n      case RETWEET_SUCCESS:\n        {\n          draft.mainPosts = draft.mainPosts.unshift(action.data);\n          break; // return {\n          //     ...state,\n          //     mainPosts: [action.data, ...state.mainPosts]\n          // };\n        }\n\n      case RETWEET_FAILURE:\n        {\n          break; // return {\n          //     ...state\n          // };\n        }\n\n      case REMOVE_POST_REQUEST:\n        {// return {\n          //     ...state\n          // };\n        }\n\n      case REMOVE_POST_SUCCESS:\n        {\n          const index = draft.mainPosts.findIndex(v => v.id === action.data);\n          draft.mainPosts.splice(index, 1); // return {\n          //     ...state,\n          //     mainPosts: state.mainPosts.filter(v => v.id !== action.data)\n          // };\n        }\n\n      case REMOVE_POST_FAILURE:\n        {\n          break; // return {\n          //     ...state\n          // };\n        }\n\n      case LOAD_POST_SUCCESS:\n        {\n          draft.singlePost = action.data;\n          break;\n        }\n\n      default:\n        {\n          break; // return {\n          //     ...state\n          // };\n        }\n    }\n  });\n}); // export default reducer;","map":{"version":3,"sources":["D:/project/react-nodebird/front/reducers/post.js"],"names":["produce","initialState","mainPosts","imagePaths","addPostErrorReason","isAddingPost","postAdded","isAddingComment","addCommentErrorReason","commentAdded","singlePost","LOAD_MAIN_POSTS_REQUEST","LOAD_MAIN_POSTS_SUCCESS","LOAD_MAIN_POSTS_FAILURE","LOAD_HASHTAG_POSTS_REQUEST","LOAD_HASHTAG_POSTS_SUCCESS","LOAD_HASHTAG_POSTS_FAILURE","LOAD_USER_POSTS_REQUEST","LOAD_USER_POSTS_SUCCESS","LOAD_USER_POSTS_FAILURE","UPLOAD_IMAGES_REQUEST","UPLOAD_IMAGES_SUCCESS","UPLOAD_IMAGES_FAILURE","REMOVE_IMAGE","ADD_POST_REQUEST","ADD_POST_SUCCESS","ADD_POST_FAILURE","LIKE_POST_REQUEST","LIKE_POST_SUCCESS","LIKE_POST_FAILURE","UNLIKE_POST_REQUEST","UNLIKE_POST_SUCCESS","UNLIKE_POST_FAILURE","ADD_COMMENT_REQUEST","ADD_COMMENT_SUCCESS","ADD_COMMENT_FAILURE","LOAD_COMMENTS_REQUEST","LOAD_COMMENTS_SUCCESS","LOAD_COMMENTS_FAILURE","RETWEET_REQUEST","RETWEET_SUCCESS","RETWEET_FAILURE","REMOVE_POST_REQUEST","REMOVE_POST_SUCCESS","REMOVE_POST_FAILURE","LOAD_POST_REQUEST","LOAD_POST_SUCCESS","LOAD_POST_FAILURE","state","action","draft","type","data","forEach","p","push","index","findIndex","v","i","splice","Added","unshift","error","postIndex","id","postId","Comments","comment","comments","lastId","hasMorePost","d","length","Likers","userId","likeIndex"],"mappings":"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","sourcesContent":["import produce from \"immer\";\r\n\r\nexport const initialState = {\r\n    mainPosts: [], // 화면에 보일 포스트들\r\n    imagePaths: [], // 미리보기 이미지 경로\r\n    addPostErrorReason: false, // 포스트 업로드 실패 사유\r\n    isAddingPost: false, // 포스트 업로드 중\r\n    postAdded: false, // 포스트 업로드 성공\r\n    isAddingComment: false,\r\n    addCommentErrorReason: \"\",\r\n    commentAdded: false,\r\n    singlePost: null\r\n};\r\n\r\nexport const LOAD_MAIN_POSTS_REQUEST = \"LOAD_MAIN_POSTS_REQUEST\";\r\nexport const LOAD_MAIN_POSTS_SUCCESS = \"LOAD_MAIN_POSTS_SUCCESS\";\r\nexport const LOAD_MAIN_POSTS_FAILURE = \"LOAD_MAIN_POSTS_FAILURE\";\r\n\r\nexport const LOAD_HASHTAG_POSTS_REQUEST = \"LOAD_HASHTAG_POSTS_REQUEST\";\r\nexport const LOAD_HASHTAG_POSTS_SUCCESS = \"LOAD_HASHTAG_POSTS_SUCCESS\";\r\nexport const LOAD_HASHTAG_POSTS_FAILURE = \"LOAD_HASHTAG_POSTS_FAILURE\";\r\n\r\nexport const LOAD_USER_POSTS_REQUEST = \"LOAD_USER_POSTS_REQUEST\";\r\nexport const LOAD_USER_POSTS_SUCCESS = \"LOAD_USER_POSTS_SUCCESS\";\r\nexport const LOAD_USER_POSTS_FAILURE = \"LOAD_USER_POSTS_FAILURE\";\r\n\r\nexport const UPLOAD_IMAGES_REQUEST = \"UPLOAD_IMAGES_REQUEST\";\r\nexport const UPLOAD_IMAGES_SUCCESS = \"UPLOAD_IMAGES_SUCCESS\";\r\nexport const UPLOAD_IMAGES_FAILURE = \"UPLOAD_IMAGES_FAILURE\";\r\n\r\nexport const REMOVE_IMAGE = \"REMOVE_IMAGE\";\r\n\r\nexport const ADD_POST_REQUEST = \"ADD_POST_REQUEST\";\r\nexport const ADD_POST_SUCCESS = \"ADD_POST_SUCCESS\";\r\nexport const ADD_POST_FAILURE = \"ADD_POST_FAILURE\";\r\n\r\nexport const LIKE_POST_REQUEST = \"LIKE_POST_REQUEST\";\r\nexport const LIKE_POST_SUCCESS = \"LIKE_POST_SUCCESS\";\r\nexport const LIKE_POST_FAILURE = \"LIKE_POST_FAILURE\";\r\n\r\nexport const UNLIKE_POST_REQUEST = \"UNLIKE_POST_REQUEST\";\r\nexport const UNLIKE_POST_SUCCESS = \"UNLIKE_POST_SUCCESS\";\r\nexport const UNLIKE_POST_FAILURE = \"UNLIKE_POST_FAILURE\";\r\n\r\nexport const ADD_COMMENT_REQUEST = \"ADD_COMMENT_REQUEST\";\r\nexport const ADD_COMMENT_SUCCESS = \"ADD_COMMENT_SUCCESS\";\r\nexport const ADD_COMMENT_FAILURE = \"ADD_COMMENT_FAILURE\";\r\n\r\nexport const LOAD_COMMENTS_REQUEST = \"LOAD_COMMENTS_REQUEST\";\r\nexport const LOAD_COMMENTS_SUCCESS = \"LOAD_COMMENTS_SUCCESS\";\r\nexport const LOAD_COMMENTS_FAILURE = \"LOAD_COMMENTS_FAILURE\";\r\n\r\nexport const RETWEET_REQUEST = \"RETWEET_REQUEST\";\r\nexport const RETWEET_SUCCESS = \"RETWEET_SUCCESS\";\r\nexport const RETWEET_FAILURE = \"RETWEET_FAILURE\";\r\n\r\nexport const REMOVE_POST_REQUEST = \"REMOVE_POST_REQUEST\";\r\nexport const REMOVE_POST_SUCCESS = \"REMOVE_POST_SUCCESS\";\r\nexport const REMOVE_POST_FAILURE = \"REMOVE_POST_FAILURE\";\r\n\r\nexport const LOAD_POST_REQUEST = \"LOAD_POST_REQUEST\";\r\nexport const LOAD_POST_SUCCESS = \"LOAD_POST_SUCCESS\";\r\nexport const LOAD_POST_FAILURE = \"LOAD_POST_FAILURE\";\r\n\r\nexport default (state = initialState, action) => {\r\n    return produce(state, draft => {\r\n        switch (action.type) {\r\n            case UPLOAD_IMAGES_REQUEST: {\r\n                break;\r\n                // return {\r\n                //     ...state\r\n                // };\r\n            }\r\n            case UPLOAD_IMAGES_SUCCESS: {\r\n                action.data.forEach(p => {\r\n                    draft.imagePaths.push(p);\r\n                });\r\n                // draft 또다른 표현 방법\r\n                // draft.imagePaths = draft.imagePaths.concat(action.data);\r\n                break;\r\n                // return {\r\n                //     ...state,\r\n                //     imagePaths: [...state.imagePaths, ...action.data]\r\n                // };\r\n            }\r\n            case UPLOAD_IMAGES_FAILURE: {\r\n                break;\r\n                // return {\r\n                //     ...state\r\n                // };\r\n            }\r\n            case REMOVE_IMAGE: {\r\n                const index = draft.imagePaths.findIndex(\r\n                    (v, i) => action.index\r\n                );\r\n                draft.imagePaths = splice(index, 1);\r\n                break;\r\n                // return {\r\n                //     ...state,\r\n                //     imagePaths: state.imagePaths.filter(\r\n                //         (v, i) => i !== action.index\r\n                //     )\r\n                // };\r\n            }\r\n            case ADD_POST_REQUEST: {\r\n                (draft.isAddingPost = true),\r\n                    (draft.addPostErrorReason = \"\"),\r\n                    (draft.Added = false);\r\n                break;\r\n                // return {\r\n                //     ...state,\r\n                //     isAddingPost: true,\r\n                //     addPostErrorReason: \"\",\r\n                //     postAdded: false\r\n                // };\r\n            }\r\n            case ADD_POST_SUCCESS: {\r\n                draft.isAddingPost = false;\r\n                draft.mainPosts.unshift(action.data);\r\n                draft.postAdded = true;\r\n                draft.imagePaths = [];\r\n                break;\r\n                // return {\r\n                //     ...state,\r\n                //     isAddingPost: false,\r\n                //     mainPosts: [action.data, ...state.mainPosts],\r\n                //     postAdded: true,\r\n                //     imagePaths: []\r\n                // };\r\n            }\r\n            case ADD_POST_FAILURE: {\r\n                draft.isAddingPost = false;\r\n                draft.addPostErrorReason = action.error;\r\n                break;\r\n                // return {\r\n                //     ...state,\r\n                //     isAddingPost: false,\r\n                //     addPostErrorReason: action.error\r\n                // };\r\n            }\r\n            case ADD_COMMENT_REQUEST: {\r\n                draft.isAddingComment = true;\r\n                draft.addCommentErrorReason = \"\";\r\n                draft.commentAdded = false;\r\n                break;\r\n                // return {\r\n                //     ...state,\r\n                //     isAddingComment: true,\r\n                //     addCommentErrorReason: \"\",\r\n                //     commentAdded: false\r\n                // };\r\n            }\r\n            case ADD_COMMENT_SUCCESS: {\r\n                const postIndex = draft.mainPosts.findIndex(\r\n                    v => v.id === action.data.postId\r\n                );\r\n                draft.mainPosts[postIndex].Comments.push(action.data.comment);\r\n                draft.isAddingComment = false;\r\n                draft.commentAdded = true;\r\n                break;\r\n                // const postIndex = state.mainPosts.findIndex(\r\n                //     v => v.id === action.data.postId\r\n                // );\r\n                // const post = state.mainPosts[postIndex];\r\n                // const Comments = [...post.Comments, action.data.comment];\r\n                // const mainPosts = [...state.mainPosts];\r\n                // mainPosts[postIndex] = { ...post, Comments };\r\n                // return {\r\n                //     ...state,\r\n                //     isAddingComment: false,\r\n                //     mainPosts,\r\n                //     commentAdded: true\r\n                // };\r\n            }\r\n            case ADD_COMMENT_FAILURE: {\r\n                draft.isAddingComment = false;\r\n                draft.addCommentErrorReason = action.error;\r\n                // return {\r\n                //     ...state,\r\n                //     isAddingComment: false,\r\n                //     addCommentErrorReason: action.error\r\n                // };\r\n            }\r\n            case LOAD_COMMENTS_SUCCESS: {\r\n                const postIndex = draft.mainPosts.findIndex(\r\n                    v => v.id === action.data.postId\r\n                );\r\n                draft.mainPosts[postIndex].Comments = action.data.comments;\r\n                break;\r\n\r\n                // const postIndex = state.mainPosts.findIndex(\r\n                //     v => v.id === action.data.postId\r\n                // );\r\n                // const post = state.mainPosts[postIndex];\r\n                // const Comments = action.data.comments;\r\n                // const mainPosts = [...state.mainPosts];\r\n                // mainPosts[postIndex] = { ...post, Comments };\r\n                // return {\r\n                //     ...state,\r\n                //     mainPosts\r\n                // };\r\n            }\r\n            // a\r\n            case LOAD_MAIN_POSTS_REQUEST:\r\n            case LOAD_HASHTAG_POSTS_REQUEST:\r\n            case LOAD_USER_POSTS_REQUEST: {\r\n                draft.mainPosts = !action.lastId ? [] : state.mainPosts;\r\n                draft.hasMorePost = action.lastId ? state.hasMorePost : true;\r\n                break;\r\n                // return {\r\n                //     ...state,\r\n                //     // 페이지 처음 들어왔을 땐 초기화하고 기존 게시글 보고 있는\r\n                //     // 상태에서 스크롤 내릴 땐 기존 게시글들 유지\r\n                //     mainPosts: action.lastId === 0 ? [] : state.mainPosts,\r\n                //     hasMorePost: action.lastId ? state.hasMorePost : true\r\n                // };\r\n            }\r\n            case LOAD_MAIN_POSTS_SUCCESS:\r\n            case LOAD_HASHTAG_POSTS_SUCCESS:\r\n            case LOAD_USER_POSTS_SUCCESS: {\r\n                action.data.forEach(d => {\r\n                    draft.mainPosts.push(d);\r\n                });\r\n                draft.hasMorePost = action.data.length === 10;\r\n                break;\r\n                // return {\r\n                //     ...state,\r\n                //     mainPosts: state.mainPosts.concat(action.data),\r\n                //     hasMorePost: action.data.length === 10 // 스크롤을 더 활성화할지 말지 결정\r\n                // };\r\n            }\r\n            case LOAD_MAIN_POSTS_FAILURE:\r\n            case LOAD_HASHTAG_POSTS_FAILURE:\r\n            case LOAD_USER_POSTS_FAILURE: {\r\n                break;\r\n            }\r\n            case LIKE_POST_REQUEST: {\r\n                break;\r\n            }\r\n            case LIKE_POST_SUCCESS: {\r\n                const postIndex = draft.mainPosts.findIndex(\r\n                    v => v.id === action.data.postId\r\n                );\r\n                draft.mainPosts[postIndex].Likers.unshift({\r\n                    id: action.data.userId\r\n                });\r\n                break;\r\n                // const postIndex = state.mainPosts.findIndex(\r\n                //     v => v.id === action.data.postId\r\n                // );\r\n                // const post = state.mainPosts[postIndex];\r\n                // const Likers = [{ id: action.data.userId }, ...post.Likers];\r\n                // const mainPosts = [...state.mainPosts];\r\n                // mainPosts[postIndex] = { ...post, Likers };\r\n                // return {\r\n                //     ...state,\r\n                //     mainPosts\r\n                // };\r\n            }\r\n            case LIKE_POST_FAILURE: {\r\n                break;\r\n                // return {\r\n                //     ...state\r\n                // };\r\n            }\r\n            case UNLIKE_POST_REQUEST: {\r\n                break;\r\n                // return {\r\n                //     ...state\r\n                // };\r\n            }\r\n            case UNLIKE_POST_SUCCESS: {\r\n                const postIndex = draft.mainPosts.findIndex(\r\n                    v => v.id === action.data.postId\r\n                );\r\n                const likeIndex = draft.mainPosts[postIndex].Likers.findIndex(\r\n                    v => v.id === action.data.userId\r\n                );\r\n                draft.mainPosts[postIndex].Likers.splice(likeIndex, 1);\r\n\r\n                // const postIndex = state.mainPosts.findIndex(\r\n                //     v => v.id === action.data.postId\r\n                // );\r\n                // const post = state.mainPosts[postIndex];\r\n                // const Likers = post.Likers.filter(\r\n                //     v => v.id !== action.data.userId\r\n                // );\r\n                // const mainPosts = [...state.mainPosts];\r\n                // mainPosts[postIndex] = { ...post, Likers };\r\n                // return {\r\n                //     ...state,\r\n                //     mainPosts\r\n                // };\r\n            }\r\n            case UNLIKE_POST_FAILURE: {\r\n                break;\r\n                // return {\r\n                //     ...state\r\n                // };\r\n            }\r\n            case RETWEET_REQUEST: {\r\n                break;\r\n                // return {\r\n                //     ...state\r\n                // };\r\n            }\r\n            case RETWEET_SUCCESS: {\r\n                draft.mainPosts = draft.mainPosts.unshift(action.data);\r\n                break;\r\n                // return {\r\n                //     ...state,\r\n                //     mainPosts: [action.data, ...state.mainPosts]\r\n                // };\r\n            }\r\n            case RETWEET_FAILURE: {\r\n                break;\r\n                // return {\r\n                //     ...state\r\n                // };\r\n            }\r\n            case REMOVE_POST_REQUEST: {\r\n                // return {\r\n                //     ...state\r\n                // };\r\n            }\r\n            case REMOVE_POST_SUCCESS: {\r\n                const index = draft.mainPosts.findIndex(\r\n                    v => v.id === action.data\r\n                );\r\n                draft.mainPosts.splice(index, 1);\r\n                // return {\r\n                //     ...state,\r\n                //     mainPosts: state.mainPosts.filter(v => v.id !== action.data)\r\n                // };\r\n            }\r\n            case REMOVE_POST_FAILURE: {\r\n                break;\r\n                // return {\r\n                //     ...state\r\n                // };\r\n            }\r\n            case LOAD_POST_SUCCESS: {\r\n                draft.singlePost = action.data;\r\n                break;\r\n            }\r\n            default: {\r\n                break;\r\n                // return {\r\n                //     ...state\r\n                // };\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n// export default reducer;\r\n"]},"metadata":{},"sourceType":"module"}